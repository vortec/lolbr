<html>
<head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <link rel="stylesheet" type="text/css" href="/css/lolbr.css" />

    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/jquery-1.4.2.min.js"></script>
    <script src="/js/client_handlers.js"></script>
    <script src="/js/ui.js"></script>
    <script>
        var socket = false;
        var roomname = window.location.pathname.split('/')[1];

        function encode_utf8(text) {
            return unescape(encodeURIComponent(text));
        }

        function decode_utf8(text) {
            return decodeURIComponent(escape(text));
        }


        function addToLog(text) {
            $('#log').append(text + '<br/>');
            scrollToChatBottom();
        }

        function updateUserlist(nicknames) {
            for (var i in nicknames) {
                var nickname = nicknames[i];
                var nickname_elem = document.createElement('li');
                nickname_elem.setAttribute('id', 'user_'+nickname);
                nickname_elem.innerHTML = nickname;
                document.getElementById('user_list_elem').appendChild(nickname_elem);
            }
        }

        function submit() {
            var text = $('#input').val();
            text = encode_utf8(text);
            socket.emit('MESSAGE', {'text': text});
            clearInputField();
        }

        function connect() {
            var host = window.location.hostname;
            socket = io.connect('http://' + host);
            for (var event in handlers) {
                socket.on(event, handlers[event]);
            }
        }

        $(window).ready(function() {
            adjustComponentDimensions();
            assignListeners();
            connect();
        });
    </script>
</head>
<body>

    <div id="top_bar">
        <span id="top_bar_roomname"></span> <span id="top_bar_topic"></span>
    </div>

    <div id="log"></div>
    <div id="user_list">
        <ul id="user_list_elem">

        </ul>
    </div>
    
    <!--div id="content"></div-->

    <div id="bottom_bar">
        <span id="username"></span><input id="input" type="text" />
    </div>


</body>
</html>
