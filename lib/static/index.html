<html>
<head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <link rel="stylesheet" type="text/css" href="/css/lolbr.css" />

    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/jquery-1.4.2.min.js"></script>

    <script src="/js/client_handlers.js"></script>
    <script src="/js/models/room.js"></script>
    <script src="/js/models/user.js"></script>
    <script src="/js/views/log.js"></script>
    <script src="/js/views/ui.js"></script>
    <script src="/js/views/userlist.js"></script>
    <script src="/js/views/text.js"></script>

    <script>
        var log, room, socket, user, userlist;
        $(window).ready(function() {
            log = new Log($('#log'));
            userlist = new Userlist($('#user_list_elem'));

            var roomname = window.location.pathname.split('/')[1];
            room = new Room(roomname);

            assignListeners();
            connect();
        });
        log = new Log();


        function updateUserlist(nicknames) {
            for (var i in nicknames) {
                var nickname = nicknames[i];
                var nickname_elem = document.createElement('li');
                nickname_elem.setAttribute('id', 'user_'+nickname);
                nickname_elem.innerHTML = nickname;
                document.getElementById('user_list_elem').appendChild(nickname_elem);
            }
        }

        function submit() {
            var text = $('#input').val();
            user.push('MESSAGE', {'text': text});
            clearInputField();
        }

        function connect() {
            var host = window.location.hostname;
            socket = io.connect('http://' + host);
            for (var event in handlers) {
                socket.on(event, handlers[event]);
            }
        }
    </script>
</head>
<body>

    <div id="top_bar">
        <span id="top_bar_roomname"></span> <span id="top_bar_topic"></span>
    </div>

    <div id="log"></div>
    <div id="user_list">
        <ul id="user_list_elem">

        </ul>
    </div>
    
    <!--div id="content"></div-->

    <div id="bottom_bar">
        <span id="username"></span><input id="input" type="text" />
    </div>


</body>
</html>
